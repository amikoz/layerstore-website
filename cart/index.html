<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Warenkorb | LayerStore</title>
    <link rel="preload" href="/ls-logo-beige.svg" as="image">
    <link rel="dns-prefetch" href="//fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #FAF9F0;
            --bg-secondary: #F5F3EB;
            --text-primary: #1a1a1a;
            --text-secondary: #666666;
            --accent: #232F3D;
            --accent-light: #4A5A6A;
            --border: #e7e5e4;
            --danger: #dc2626;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Quicksand', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
        }

        /* Header */
        header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            padding: 1.2rem 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #232E3D;
            z-index: 1000;
        }

        .logo {
            display: flex;
            align-items: center;
            text-decoration: none;
        }

        .logo img {
            height: 24px;
            width: auto;
            padding: 6px 0;
            transition: transform 0.2s ease;
        }

        .logo:hover img {
            transform: scale(1.05);
        }

        nav {
            display: flex;
            gap: 1.5rem;
            align-items: center;
        }

        nav a {
            text-decoration: none;
            color: rgba(255, 255, 255, 0.85);
            font-size: 0.8rem;
            font-weight: 400;
            letter-spacing: 0.02em;
            transition: color 0.3s ease;
            position: relative;
        }

        nav a:hover {
            color: white;
        }

        nav a::after {
            content: '';
            position: absolute;
            bottom: -3px;
            left: 0;
            width: 0;
            height: 1.5px;
            background: white;
            transition: width 0.3s ease;
        }

        nav a:hover::after {
            width: 100%;
        }

        /* Cart Icon */
        .cart-icon {
            position: relative;
            cursor: pointer;
            padding: 0.3rem 0.5rem;
            transition: transform 0.2s ease;
        }

        .cart-icon svg {
            width: 20px;
            height: 20px;
            fill: #F0ECDA;
            transition: fill 0.3s ease;
        }

        .cart-icon:hover svg {
            fill: white;
        }

        .cart-count {
            position: absolute;
            top: -2px;
            right: -2px;
            background: var(--accent);
            color: white;
            font-size: 0.65rem;
            font-weight: 600;
            min-width: 16px;
            height: 16px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 4px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .cart-count.visible {
            opacity: 1;
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            border-left: 4px solid var(--accent);
            border-radius: 8px;
            padding: 1.5rem 2rem;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
            z-index: 3000;
            transform: translateX(400px);
            opacity: 0;
            transition: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            max-width: 400px;
        }

        .toast.show {
            transform: translateX(0);
            opacity: 1;
        }

        .toast.success {
            border-left-color: #10b981;
        }

        .toast.error {
            border-left-color: #ef4444;
        }

        .toast-title {
            font-family: 'Quicksand', sans-serif;
            font-size: 1.3rem;
            font-weight: 400;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        .toast-message {
            font-size: 0.95rem;
            color: var(--text-secondary);
            line-height: 1.5;
        }

        .toast.success .toast-title {
            color: #10b981;
        }

        .toast.error .toast-title {
            color: #ef4444;
        }

        /* Main Content */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 8rem 2rem 4rem;
        }

        h1 {
            font-family: 'Quicksand', sans-serif;
            font-size: clamp(2.5rem, 5vw, 3.5rem);
            font-weight: 400;
            margin-bottom: 2rem;
            letter-spacing: -0.02em;
            color: var(--accent);
        }

        /* Empty Cart */
        .empty-cart {
            text-align: center;
            padding: 6rem 2rem;
            background: white;
            border-radius: 12px;
            border: 1px solid var(--border);
        }

        .empty-cart svg {
            width: 120px;
            height: 120px;
            fill: var(--border);
            margin-bottom: 2rem;
        }

        .empty-cart h2 {
            font-size: 1.8rem;
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }

        .empty-cart p {
            color: var(--text-secondary);
            margin-bottom: 2rem;
        }

        .btn-primary {
            display: inline-block;
            padding: 1rem 2.5rem;
            background: var(--accent);
            color: white;
            text-decoration: none;
            font-size: 0.9rem;
            font-weight: 400;
            letter-spacing: 0.05em;
            text-transform: uppercase;
            transition: all 0.3s ease;
            border: 2px solid var(--accent);
            border-radius: 4px;
        }

        .btn-primary:hover {
            background: transparent;
            color: var(--accent);
        }

        /* Cart Items */
        .cart-items {
            display: grid;
            gap: 1.5rem;
            margin-bottom: 3rem;
        }

        .cart-item {
            display: grid;
            grid-template-columns: 120px 1fr auto;
            gap: 2rem;
            padding: 0.5rem 1rem;
            background: white;
            border-radius: 12px;
            border: 1px solid var(--border);
            align-items: center;
        }

        .cart-item-image {
            width: 120px;
            height: 120px;
            object-fit: cover;
            border-radius: 8px;
            background: var(--bg-secondary);
        }

        .cart-item-details {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .cart-item-name {
            font-family: 'Quicksand', sans-serif;
            font-size: 1.4rem;
            color: var(--accent);
        }

        .cart-item-color {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .cart-item-options {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
            margin-bottom: 0.5rem;
        }

        .cart-item-size {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .cart-item-size-desc {
            font-size: 0.85rem;
            color: var(--text-secondary);
            font-style: italic;
            display: block;
            margin-top: 0.25rem;
        }

        .cart-item-marble {
            font-size: 0.85rem;
            color: #92400e;
            font-weight: 500;
        }
        }

        .cart-item-price {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--accent);
        }

        .cart-item-actions {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 1rem;
        }

        .quantity-controls {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .quantity-btn {
            width: 32px;
            height: 32px;
            border: 1px solid var(--border);
            background: white;
            color: var(--text-primary);
            border-radius: 4px;
            cursor: pointer;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .quantity-btn:hover {
            border-color: var(--accent);
            color: var(--accent);
        }

        .quantity-value {
            width: 50px;
            text-align: center;
            font-size: 1rem;
            font-weight: 600;
        }

        .remove-btn {
            padding: 0.5rem 1rem;
            background: transparent;
            color: var(--danger);
            border: 1px solid var(--danger);
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.3s ease;
        }

        .remove-btn:hover {
            background: var(--danger);
            color: white;
        }

        /* Cart Summary */
        .cart-summary {
            background: white;
            border-radius: 12px;
            border: 1px solid var(--border);
            padding: 0.5rem 1rem;
            max-width: 400px;
            margin-left: auto;
        }

        .summary-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1rem;
            font-size: 1rem;
        }

        .summary-row.total {
            border-top: 2px solid var(--border);
            padding-top: 1rem;
            margin-top: 1rem;
            font-size: 1.3rem;
            font-weight: 600;
        }

        .summary-row.discount {
            color: #22c55e;
            font-weight: 500;
        }

        /* Promo Code Section */
        .promo-code-section {
            margin: 1.5rem 0;
            padding: 1rem;
            background: var(--bg-secondary);
            border-radius: 8px;
        }

        .promo-code-label {
            font-size: 0.9rem;
            font-weight: 500;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        .promo-code-input-group {
            display: flex;
            gap: 0.5rem;
        }

        .promo-code-input {
            flex: 1;
            padding: 0.75rem;
            border: 1px solid var(--border);
            border-radius: 4px;
            font-size: 0.9rem;
            font-family: inherit;
            transition: border-color 0.3s ease;
        }

        .promo-code-input:focus {
            outline: none;
            border-color: var(--accent);
        }

        .promo-code-input.invalid {
            border-color: var(--danger);
        }

        .promo-code-input.valid {
            border-color: #22c55e;
        }

        .promo-code-apply-btn {
            padding: 0.75rem 1.25rem;
            background: var(--accent);
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .promo-code-apply-btn:hover {
            background: var(--accent-light);
        }

        .promo-code-input-group {
            display: flex;
            gap: 0.5rem;
        }

        .promo-code-applied {
            display: none;
            align-items: center;
            justify-content: space-between;
            margin-top: 0.75rem;
            padding: 0.6rem 0.75rem;
            background: #dcfce7;
            border: 1px solid #86efac;
            border-radius: 4px;
            font-size: 0.85rem;
        }

        .promo-code-applied.visible {
            display: flex;
        }

        .promo-code-applied-text {
            color: #166534;
            font-weight: 500;
        }

        .promo-code-applied-remove {
            background: none;
            border: none;
            color: #166534;
            cursor: pointer;
            font-size: 1.2rem;
            font-weight: 600;
            padding: 0 0.3rem;
            line-height: 1;
            transition: color 0.2s ease;
        }

        .promo-code-applied-remove:hover {
            color: #dc2626;
        }

        .promo-code-message {
            font-size: 0.85rem;
            margin-top: 0.5rem;
            padding: 0.5rem;
            border-radius: 4px;
            display: none;
        }

        .promo-code-message.success {
            display: block;
            color: #22c55e;
            background: #dcfce7;
        }

        .promo-code-message.error {
            display: block;
            color: var(--danger);
            background: #fecaca;
        }

        .checkout-btn {
            width: 100%;
            padding: 0.5rem 1rem;
            background: var(--accent);
            color: white;
            border: 2px solid var(--accent);
            border-radius: 4px;
            font-size: 1rem;
            font-weight: 400;
            letter-spacing: 0.05em;
            text-transform: uppercase;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 2rem;
        }

        .checkout-btn:hover {
            background: transparent;
            color: var(--accent);
        }

        /* Continue Shopping */
        .continue-shopping {
            margin-top: 2rem;
        }

        .continue-shopping a {
            color: var(--text-secondary);
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            transition: color 0.3s ease;
        }

        .continue-shopping a:hover {
            color: var(--accent);
        }

        /* Checkout Modal */
        .checkout-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }

        .checkout-modal.active {
            display: flex;
        }

        .checkout-modal-content {
            background: white;
            border-radius: 16px;
            padding: 0.5rem 1rem;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            position: relative;
        }

        .checkout-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            color: var(--text-secondary);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .checkout-close:hover {
            background: var(--accent);
            color: white;
            transform: rotate(90deg);
            border-color: var(--accent);
        }

        .checkout-modal h2 {
            font-family: 'Quicksand', sans-serif;
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
            color: var(--accent);
        }

        .checkout-modal p {
            color: var(--text-secondary);
            margin-bottom: 2rem;
            font-size: 0.95rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            font-size: 0.9rem;
            font-weight: 500;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        .form-group input {
            width: 100%;
            padding: 0.875rem 1rem;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 1rem;
            font-family: inherit;
            transition: all 0.3s ease;
        }

        .form-group input:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(234, 88, 12, 0.1);
        }

        .form-group input.error {
            border-color: var(--danger);
        }

        .error-message {
            color: var(--danger);
            font-size: 0.85rem;
            margin-top: 0.5rem;
            display: none;
        }

        .error-message.visible {
            display: block;
        }

        .checkout-submit-btn {
            width: 100%;
            padding: 0.5rem 1rem;
            background: var(--accent);
            color: white;
            border: 2px solid var(--accent);
            border-radius: 4px;
            font-size: 1rem;
            font-weight: 400;
            letter-spacing: 0.05em;
            text-transform: uppercase;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .checkout-submit-btn:hover {
            background: transparent;
            color: var(--accent);
        }

        .checkout-submit-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .checkout-buttons {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-top: 2rem;
        }

        .privacy-consent {
            margin-top: 1.5rem;
        }

        .privacy-consent label {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            font-size: 0.85rem;
            color: var(--text-secondary);
            cursor: pointer;
            line-height: 1.4;
        }

        .privacy-consent input[type="checkbox"] {
            width: 18px;
            height: 18px;
            min-width: 18px;
            margin-top: 2px;
            cursor: pointer;
            accent-color: var(--accent);
        }

        .privacy-consent a {
            color: var(--accent);
            text-decoration: underline;
        }


        .btn-whatsapp {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            width: 100%;
            padding: 0.5rem 1rem;
            background: #25D366;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 1rem;
            font-weight: 500;
            letter-spacing: 0.02em;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
        }

        .btn-whatsapp:hover {
            background: #128C7E;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(37, 211, 102, 0.3);
        }

        .btn-email {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            width: 100%;
            padding: 0.5rem 1rem;
            background: var(--accent);
            color: white;
            border: 2px solid var(--accent);
            border-radius: 4px;
            font-size: 1rem;
            font-weight: 400;
            letter-spacing: 0.02em;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
        }

        .btn-email:hover {
            background: transparent;
            color: var(--accent);
        }

        .btn-whatsapp:disabled,
        .btn-email:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            pointer-events: none;
        }

        .btn-whatsapp:disabled:hover,
        .btn-email:disabled:hover {
            background: #25D366;
            transform: none;
            box-shadow: none;
        }

        .btn-email:disabled:hover {
            background: white;
            color: var(--accent);
            border-color: var(--accent);
        }

        .btn-call {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            width: 100%;
            padding: 0.5rem 1rem;
            background: #22c55e;
            color: white;
            border: 2px solid #22c55e;
            border-radius: 4px;
            font-size: 1rem;
            font-weight: 400;
            letter-spacing: 0.02em;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
        }

        .checkout-choice-text {
            text-align: center;
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-top: 1rem;
            margin-bottom: 1.5rem;
        }

        .checkout-choice-text strong {
            color: var(--accent);
        }

        /* Footer */
        footer {
            padding: 4rem 4rem;
            background: var(--bg-primary);
            border-top: 1px solid var(--border);
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 2fr 1fr 1fr;
            gap: 3rem;
        }

        .footer-section h4 {
            font-family: 'Quicksand', sans-serif;
            font-size: 1.2rem;
            font-weight: 400;
            margin-bottom: 1rem;
            color: var(--accent);
        }

        .footer-section p {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
            font-weight: 300;
        }

        .footer-section a {
            color: var(--text-secondary);
            text-decoration: none;
            display: block;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
            transition: color 0.3s ease;
        }

        .footer-section a:hover {
            color: var(--accent);
        }

        .footer-bottom {
            text-align: center;
            margin-top: 3rem;
            padding-top: 2rem;
            border-top: 1px solid var(--border);
            font-size: 0.85rem;
            color: var(--text-secondary);
            font-weight: 300;
        }

        /* Responsive */
        @media (max-width: 768px) {
            header {
                padding: 0.65rem 0.75rem;
            }

            .logo img {
                height: 22px;
                padding: 5px 0;
            }

            nav {
                gap: 0.75rem;
            }

            nav a {
                font-size: 0.75rem;
            }

            .container {
                padding: 2rem 1rem;
            }

            .cart-item {
                grid-template-columns: 80px 1fr;
                gap: 1rem;
            }

            .cart-item-image {
                width: 80px;
                height: 80px;
                grid-row: span 2;
            }

            .cart-item-actions {
                grid-column: span 2;
                flex-direction: row;
                justify-content: space-between;
                align-items: center;
                width: 100%;
            }

            .cart-summary {
                max-width: 100%;
            }

            .footer-content {
                grid-template-columns: 1fr;
                gap: 2rem;
            }
        }

        /* Cookie Banner */
        .cookie-banner {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: #232E3D;
            border-top: 1px solid var(--border);
            padding: 1.5rem 2rem;
            z-index: 9999;
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1);
            display: none;
            align-items: center;
            justify-content: center;
            gap: 2rem;
        }

        .cookie-banner.show {
            display: flex;
        }

        .cookie-banner p {
            margin: 0;
            font-size: 0.9rem;
            color: var(--text-secondary);
            flex: 1;
            max-width: 800px;
        }

        .cookie-banner a {
            color: var(--accent);
            text-decoration: underline;
        }

        .cookie-banner button {
            padding: 0.6rem 1.5rem;
            background: var(--accent);
            color: white;
            border: none;
            border-radius: 4px;
            font-family: 'Quicksand', sans-serif;
            font-size: 0.85rem;
            font-weight: 500;
            cursor: pointer;
            transition: background 0.3s ease;
            white-space: nowrap;
        }

        .cookie-banner button:hover {
            background: var(--accent-light);
        }

        @media (max-width: 768px) {
            .cookie-banner {
                flex-direction: column;
                gap: 1rem;
                padding: 1.5rem;
            }

            .cookie-banner p {
                font-size: 0.85rem;
            }

            .cookie-banner button {
                width: 100%;
            }
        }
    </style>

    <!-- Stripe.js -->
    <style>
        /* Stripe Payment Form */
        .stripe-payment-option {
            margin-top: 1rem;
        }

        .payment-methods-tabs {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .payment-tab {
            flex: 1;
            padding: 0.75rem 1rem;
            border: 2px solid var(--border);
            border-radius: 8px;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            font-weight: 500;
            text-align: center;
        }

        .payment-tab:hover {
            border-color: var(--accent);
        }

        .payment-tab.active {
            border-color: var(--accent);
            background: var(--accent);
            color: white;
        }

        .payment-content {
            display: none;
            margin-top: 1rem;
        }

        .payment-content.active {
            display: block;
        }

        .stripe-card-element {
            padding: 0.875rem 1rem;
            border: 1px solid var(--border);
            border-radius: 8px;
            background: white;
        }

        .stripe-card-element:focus-within {
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(35, 47, 61, 0.1);
        }

        .stripe-button {
            width: 100%;
            padding: 1rem;
            margin-top: 1rem;
            background: #635bff;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .stripe-button:hover:not(:disabled) {
            background: #534eb4;
        }

        .stripe-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .stripe-error {
            color: var(--danger);
            font-size: 0.85rem;
            margin-top: 0.5rem;
            display: none;
        }

        .stripe-error.visible {
            display: block;
        }

        .stripe-icon {
            width: 40px;
            height: 24px;
        }
    </style>

    <!-- Stripe.js -->
    <script src="https://js.stripe.com/v3/"></script>
</head>
<body>
    <!-- Header -->
    <header>
        <a href="/" class="logo">
            <img src="/ls-logo-beige.svg" alt="LayerStore Logo" width="60" height="24" loading="eager" decoding="sync" fetchpriority="high">
        </a>
        <nav>
            <a href="/">Startseite</a>
            <a href="/collections/easter">Kollektion</a>
            <div class="cart-icon" id="cartIcon" title="Warenkorb">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h7.45c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.08-.14.12-.31.12-.48 0-.55-.45-1-1-1H5.21l-.94-2H1zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2z"/>
                </svg>
                <span class="cart-count" id="cartCount">0</span>
            </div>
        </nav>
    </header>

    <!-- Main Content -->
    <div class="container">
        <h1>Ihr Warenkorb</h1>

        <div id="cartContent">
            <!-- Cart items will be rendered here -->
        </div>

        <div class="continue-shopping">
            <a href="/collections/easter">
                ‚Üê Weiter einkaufen
            </a>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h4>LayerStore</h4>
                <p>Individuelle 3D-Druck-Kreationen f√ºr jeden Anlass.</p>
                <p>¬© 2026 LayerStore. Alle Rechte vorbehalten.</p>
            </div>

            <div class="footer-section">
                <h4>Entdecken</h4>
                <a href="/collections">Kollektionen</a>
                <a href="/collections/easter">üê∞ Ostern</a>
                <a href="/cart">Warenkorb</a>
            </div>

            <div class="footer-section">
                <h4>Rechtliches</h4>
                <a href="/datenschutz">üîí Datenschutz</a>
                <a href="/impressum">‚ÑπÔ∏è Impressum</a>
                <a href="/contact">üìß Kontakt</a>
            </div>
        </div>

        <div class="footer-bottom">
            Mit Pr√§zision gedruckt in Deutschland
        </div>
    </footer>

    <!-- Checkout Modal -->
    <div class="checkout-modal" id="checkoutModal">
        <div class="checkout-modal-content">
            <button class="checkout-close" id="closeCheckout">√ó</button>
            <h2>Anfrage senden</h2>
            <p>Bitte geben Sie Ihre Kontaktdaten ein und w√§hlen Sie Ihre Bezahlart.</p>

            <div id="checkoutForm">
                <div class="form-group">
                    <label for="customerName">Name (optional)</label>
                    <input
                        type="text"
                        id="customerName"
                        name="name"
                        placeholder="Ihr Name"
                    >
                </div>

                <!-- Payment Method Tabs -->
                <div class="payment-methods-tabs">
                    <div class="payment-tab active" data-method="stripe">
                        <svg class="stripe-icon" viewBox="0 0 40 24" xmlns="http://www.w3.org/2000/svg">
                            <path fill="#635bff" d="M20.4,6.8H13c0-0.6-0.5-1-1-1s-1,0.4-1,1v6.5c0,0.6-0.5,1-1,1s-1-0.4-1-1V7.8c0-1.7,1.3-3,3-3c1.7,0,3,1.3,3,3v5.5c0,0.6-0.5,1-1,1s-1-0.4-1-1V7.8c0-1-0.9-2-2-2s-2,0.9-2,2v5.5c0,0.6-0.5,1-1,1s-1-0.4-1-1V7.8c0-2.8,2.2-5,5-5c2.8,0,5,2.2,5,5v5.5c0,0.6-0.5,1-1,1s-1-0.4-1-1V7.8c0-1.7-1.3-3-3-3c-1.7,0-3,1.3-3,3v6.5c0,0.6,0.5,1,1,1s1-0.4,1-1V7.8z"/>
                            <path fill="#00D6A6" d="M36.4,13.8c-0.3,0-0.5-0.2-0.5-0.5V9.2c0-0.3,0.2-0.5,0.5-0.5s0.5,0.2,0.5,0.5v4.2C36.9,13.7,36.7,13.8,36.4,13.8z"/>
                            <path fill="#00D6A6" d="M38.4,13.8c-0.3,0-0.5-0.2-0.5-0.5V9.2c0-0.3,0.2-0.5,0.5-0.5s0.5,0.2,0.5,0.5v4.2C38.9,13.7,38.7,13.8,38.4,13.8z"/>
                        </svg>
                        Karte
                    </div>
                    <div class="payment-tab" data-method="whatsapp">
                        WhatsApp
                    </div>
                    <div class="payment-tab" data-method="email">
                        E-Mail
                    </div>
                </div>

                <!-- Stripe Payment Content -->
                <div class="payment-content active" id="stripeContent">
                    <div id="card-element" class="stripe-card-element"></div>
                    <div id="stripe-error" class="stripe-error" role="alert"></div>
                    <button id="submitPaymentBtn" class="stripe-button" disabled>
                        <span id="buttonText">Jetzt bezahlen</span>
                        <span id="buttonLoading" style="display:none;">Verarbeite...</span>
                    </button>
                    <p style="font-size: 0.75rem; color: #999; margin-top: 0.5rem; text-align: center;">
                        üîí Sichere Zahlung mit Stripe
                    </p>
                </div>

                <!-- WhatsApp Content -->
                <div class="payment-content" id="whatsappContent">
                    <p style="margin-bottom: 1rem;">Wir senden Ihnen Ihre Bestellung √ºber WhatsApp und melden uns f√ºr die Bezahlung.</p>
                    <button class="btn-whatsapp" id="whatsappBtn" disabled style="width: 100%;">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                            <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
                        </svg>
                        √úber WhatsApp bestellen
                    </button>
                </div>

                <!-- Email Content -->
                <div class="payment-content" id="emailContent">
                    <p style="margin-bottom: 1rem;">Wir senden Ihnen Ihre Bestellung per E-Mail und melden uns f√ºr die Bezahlung.</p>
                    <button class="btn-email" id="emailBtn" disabled style="width: 100%;">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                            <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/>
                        </svg>
                        √úber E-Mail bestellen
                    </button>
                </div>

                <div class="privacy-consent">
                    <label>
                        <input type="checkbox" id="privacyConsent">
                        <span>Ich stimme der Verarbeitung meiner Daten gem√§√ü der <a href="/datenschutz" target="_blank">Datenschutzerkl√§rung</a> zu. *</span>
                    </label>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast">
        <div class="toast-title" id="toastTitle"></div>
        <div class="toast-message" id="toastMessage"></div>
    </div>

    <script>
        // Product data
        const products = {
            osterkarotte: {
                name: 'Osterkarotte',
                price: '13,00 ‚Ç¨',
                images: ['/collections/easter/images/carrot1.jpeg']
            },
            hasenkorb: {
                name: 'Hasenkorb',
                price: '13,00 ‚Ç¨',
                images: ['/collections/easter/images/bunnybasketbeige.jpeg']
            },
            osterei: {
                name: 'Osterei mit Beinen',
                price: '2,00 ‚Ç¨',
                images: ['/collections/easter/images/legseggkinder.jpeg']
            },
            gestricktesei: {
                name: 'Gestricktes Ei',
                price: '5,00 ‚Ç¨',
                images: ['/collections/easter/images/knittedeggmintgreen.jpeg']
            },
            kinderhalter: {
                name: 'Hasen-Kinderhalter',
                price: '3,00 ‚Ç¨',
                images: ['/collections/easter/images/bunnykinderholder.jpeg']
            },
            hasemmitkorb: {
                name: 'Hase mit Korb',
                price: '5,00 ‚Ç¨',
                images: ['/collections/easter/images/bunnywithbasket.jpeg']
            },
            kinderrahmen: {
                name: 'Hasen-Kinderrahmen',
                price: '2,00 ‚Ç¨',
                images: ['/collections/easter/images/kinderrahmen.jpg']
            }
        };

        const colorNames = {
            beige: 'Beige',
            pink: 'Pink',
            purple: 'Purple',
            red: 'Red',
            orange: 'Orange',
            yellow: 'Yellow',
            lemonyellow: 'Lemon Yellow',
            lightgreen: 'Light Green',
            mintgreen: 'Mint Green',
            olivegreen: 'Olive Green',
            skyblue: 'Sky Blue',
            blue: 'Blue',
            deeppink: 'Deep Pink',
            newpink: 'New Pink',
            standard: 'Standard',
            custom: 'Custom'
        };

        // Get cart from localStorage
        function getCart() {
            const cart = localStorage.getItem('layerstore_cart');
            return cart ? JSON.parse(cart) : [];
        }

        // Save cart to localStorage
        function saveCart(cart) {
            localStorage.setItem('layerstore_cart', JSON.stringify(cart));
            updateCartCount();
        }

        // Update cart count in header
        function updateCartCount() {
            const cart = getCart();
            const totalCount = cart.reduce((sum, item) => sum + item.quantity, 0);
            const cartCount = document.getElementById('cartCount');
            cartCount.textContent = totalCount;

            if (totalCount > 0) {
                cartCount.classList.add('visible');
            } else {
                cartCount.classList.remove('visible');
            }
        }

        // Get image path for cart item
        function getImagePath(item) {
            if (item.image) {
                return item.image.startsWith('http') || item.image.startsWith('/')
                    ? item.image
                    : `/collections/easter/images/${item.image}`;
            }
            const product = products[item.id];
            if (product && product.images && product.images[0]) {
                return `/collections/easter/images/${product.images[0]}`;
            }
            return '/collections/easter/images/placeholder.jpg';
        }

        // Render cart
        function renderCart() {
            const cart = getCart();
            const cartContent = document.getElementById('cartContent');

            if (cart.length === 0) {
                cartContent.innerHTML = `
                    <div class="empty-cart">
                        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h7.45c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.08-.14.12-.31.12-.48 0-.55-.45-1-1-1H5.21l-.94-2H1zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2z"/>
                        </svg>
                        <h2>Ihr Warenkorb ist leer</h2>
                        <p>Haben Sie keine Lust mehr? Schauen Sie sich unsere Oster-Kollektion an!</p>
                        <a href="/collections/easter" class="btn-primary">Zur Kollektion</a>
                    </div>
                `;
                return;
            }

            let itemsHTML = cart.map((item, index) => {
                const imagePath = getImagePath(item);
                const colorText = item.color && item.color !== 'standard' ? `<span class="cart-item-color">Farbe: ${colorNames[item.color] || item.color}</span>` : '';
                const marbleText = item.isMarble ? `<span class="cart-item-marble">‚ú® Marmor (+20%)</span>` : '';
                const sizeText = item.option && item.option !== 'as-photo' ? `<span class="cart-item-size">Gr√∂√üe: Nach Absprache</span>` : '';
                const sizeDescText = item.sizeDescription ? `<span class="cart-item-size-desc">${item.sizeDescription}</span>` : '';
                const optionsText = (colorText || marbleText || sizeText || sizeDescText) ? `<div class="cart-item-options">${colorText}${marbleText}${sizeText}${sizeDescText}</div>` : '';
                const priceText = item.option && item.option !== 'as-photo' ? 'null' : item.price;

                return `
                    <div class="cart-item" data-index="${index}">
                        <img src="${imagePath}" alt="${item.name}" class="cart-item-image">
                        <div class="cart-item-details">
                            <div class="cart-item-name">${item.name}</div>
                            ${optionsText}
                            <div class="cart-item-price">${priceText}</div>
                        </div>
                        <div class="cart-item-actions">
                            <div class="quantity-controls">
                                <button class="quantity-btn" onclick="updateQuantity(${index}, -1)">‚àí</button>
                                <span class="quantity-value">${item.quantity}</span>
                                <button class="quantity-btn" onclick="updateQuantity(${index}, 1)">+</button>
                            </div>
                            <button class="remove-btn" onclick="removeItem(${index})">Entfernen</button>
                        </div>
                    </div>
                `;
            }).join('');

            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);

            // Calculate total price in EUR
            const total = cart.reduce((sum, item) => {
                if (!item.price || item.option === 'individuell') return sum;
                const priceNum = parseFloat(item.price.replace(',', '.').replace(' ‚Ç¨', ''));
                return sum + (priceNum * item.quantity);
            }, 0);

            // Get discount from applied promo code
            const discount = calculateDiscount();
            const finalTotal = total - discount;

            const summaryHTML = `
                <div class="cart-summary">
                    <div class="summary-row">
                        <span>Zwischensumme:</span>
                        <span>${total.toFixed(2)} ‚Ç¨</span>
                    </div>
                    ${discount > 0 ? `
                    <div class="summary-row discount">
                        <span>Rabatt (Promo-Code):</span>
                        <span>-${discount.toFixed(2)} ‚Ç¨</span>
                    </div>
                    ` : ''}
                    <div class="summary-row">
                        <span>Anzahl Artikel:</span>
                        <span>${totalItems}</span>
                    </div>
                    <div class="summary-row total">
                        <span>Gesamt:</span>
                        <span>${finalTotal.toFixed(2)} ‚Ç¨</span>
                    </div>

                    <div class="promo-code-section">
                        <div class="promo-code-label">Promo-Code eingeben:</div>
                        <div class="promo-code-input-group">
                            <input
                                type="text"
                                id="promoCodeInput"
                                class="promo-code-input"
                                placeholder="Ihr Code"
                                maxlength="20"
                            >
                            <button class="promo-code-apply-btn" id="promoApplyBtn" onclick="applyPromoCode()">Anwenden</button>
                        </div>
                        <div id="promoCodeApplied" class="promo-code-applied${getAppliedPromoCode() ? ' visible' : ''}">
                            <span class="promo-code-applied-text">${getAppliedPromoCode() ? 'Promo-Code: ' + getAppliedPromoCode() : ''}</span>
                            <button class="promo-code-applied-remove" onclick="removePromoCode()" title="Promo-Code entfernen">√ó</button>
                        </div>
                        <div id="promoCodeMessage" class="promo-code-message"></div>
                    </div>

                    <button class="checkout-btn" onclick="checkout()">Anfrage senden</button>
                </div>
            `;

            cartContent.innerHTML = `
                <div class="cart-items">${itemsHTML}</div>
                ${summaryHTML}
            `;
        }

        // Update quantity
        function updateQuantity(index, change) {
            const cart = getCart();
            const item = cart[index];

            item.quantity += change;

            if (item.quantity <= 0) {
                cart.splice(index, 1);
            }

            saveCart(cart);
            renderCart();
        }

        // Remove item
        function removeItem(index) {
            const cart = getCart();
            cart.splice(index, 1);
            saveCart(cart);
            renderCart();
        }

        // Promo Code Management
        let PROMO_CODES = {};

        // Load promo codes from localStorage
        function loadPromoCodes() {
            const stored = localStorage.getItem('layerstore_promo_codes');
            if (stored) {
                try {
                    PROMO_CODES = JSON.parse(stored);
                } catch (e) {
                    // Default fallback
                    PROMO_CODES = {
                        'TM26MG': { discount: 0.1, description: 'Troedelmarkt Metro Godorf 01.03.2026' }
                    };
                }
            } else {
                // Default fallback
                PROMO_CODES = {
                    'TM26MG': { discount: 0.1, description: 'Troedelmarkt Metro Godorf 01.03.2026' }
                };
            }
        }

        function getAppliedPromoCode() {
            return localStorage.getItem('layerstore_promo_code') || null;
        }

        function setAppliedPromoCode(code) {
            if (code) {
                localStorage.setItem('layerstore_promo_code', code);
            } else {
                localStorage.removeItem('layerstore_promo_code');
            }
        }

        function calculateDiscount() {
            const promoCode = getAppliedPromoCode();
            if (!promoCode || !PROMO_CODES[promoCode]) {
                return 0;
            }

            const cart = getCart();
            const total = cart.reduce((sum, item) => {
                if (!item.price || item.option === 'individuell') return sum;
                const priceNum = parseFloat(item.price.replace(',', '.').replace(' ‚Ç¨', ''));
                return sum + (priceNum * item.quantity);
            }, 0);

            const discountPercent = PROMO_CODES[promoCode].discount;
            return total * discountPercent;
        }

        function applyPromoCode() {
            const input = document.getElementById('promoCodeInput');
            const messageDiv = document.getElementById('promoCodeMessage');
            const code = input.value.trim().toUpperCase();

            if (!code) {
                messageDiv.textContent = 'Bitte geben Sie einen Promo-Code ein.';
                messageDiv.className = 'promo-code-message error';
                messageDiv.style.display = 'block';
                input.classList.add('invalid');
                return;
            }

            if (PROMO_CODES[code]) {
                setAppliedPromoCode(code);
                input.classList.remove('invalid');
                input.value = '';
                messageDiv.style.display = 'none';

                // Re-render cart to update prices and show promo code
                renderCart();
            } else {
                messageDiv.textContent = '‚úó Ung√ºltiger Promo-Code';
                messageDiv.className = 'promo-code-message error';
                messageDiv.style.display = 'block';
                input.classList.add('invalid');
                input.classList.remove('valid');
                setAppliedPromoCode(null);
            }
        }

        function removePromoCode() {
            // Clear promo code
            setAppliedPromoCode(null);

            // Re-render cart to update prices and hide promo code
            renderCart();
        }

        // Allow Enter key to apply promo code
        document.addEventListener('DOMContentLoaded', () => {
            const promoInput = document.getElementById('promoCodeInput');
            if (promoInput) {
                promoInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        applyPromoCode();
                    }
                });
            }
        });

        // Checkout
        function checkout() {
            const cart = getCart();
            if (cart.length === 0) {
                alert('Ihr Warenkorb ist leer.');
                return;
            }

            // Open checkout modal
            const modal = document.getElementById('checkoutModal');
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';

            // Focus on email input
            setTimeout(() => {
                document.getElementById('customerEmail').focus();
            }, 100);
        }

        // Close checkout modal
        function closeCheckoutModal() {
            const modal = document.getElementById('checkoutModal');
            modal.classList.remove('active');
            document.body.style.overflow = '';
        }

        // Show toast notification
        function showToast(title, message, type = 'success') {
            const toast = document.getElementById('toast');
            const toastTitle = document.getElementById('toastTitle');
            const toastMessage = document.getElementById('toastMessage');

            toastTitle.textContent = title;
            toastMessage.textContent = message;
            toast.className = `toast ${type}`;

            // Show toast
            setTimeout(() => {
                toast.classList.add('show');
            }, 100);

            // Hide after 3 seconds
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);

            // Log for debugging
            console.log(`[${type.toUpperCase()}] ${title}: ${message}`);
        }

        // Prepare order details
        function prepareOrderDetails() {
            const cart = getCart();

            let orderDetails = '=== BESTELLTE ARTIKEL ===\n\n';

            let totalItems = 0;
            cart.forEach(item => {
                let itemDetails = `${item.quantity}x ${item.name}`;

                // Add color if not standard
                if (item.color && item.color !== 'standard') {
                    const colorName = colorNames[item.color] || item.color;
                    const marbleNote = item.isMarble ? ' (Marmor +20%)' : '';
                    itemDetails += `\n   Farbe: ${colorName}${marbleNote}`;
                }

                // Add size option if not as-photo
                if (item.option && item.option !== 'as-photo') {
                    itemDetails += `\n   Gr√∂√üe: Nach Absprache`;
                }

                // Add size description if provided
                if (item.sizeDescription) {
                    itemDetails += `\n   (${item.sizeDescription})`;
                }

                // Show price as null if size is custom
                const priceText = item.option && item.option !== 'as-photo' ? 'null' : item.price;
                itemDetails += ` - ${priceText}`;
                orderDetails += itemDetails + '\n';
                totalItems += item.quantity;
            });

            orderDetails += `\n=== ZUSAMMENFASSUNG ===\n`;
            orderDetails += `Gesamt: ${totalItems} Artikel\n`;

            // Add promo code info if applied
            const promoCode = getAppliedPromoCode();
            if (promoCode && PROMO_CODES[promoCode]) {
                const discount = calculateDiscount();
                orderDetails += `Promo-Code: ${promoCode}\n`;
                orderDetails += `Rabatt: -${discount.toFixed(2)} ‚Ç¨\n`;
            }

            orderDetails += `Datum: ${new Date().toLocaleDateString('de-DE')}\n`;
            orderDetails += `Zeit: ${new Date().toLocaleTimeString('de-DE')}\n`;

            return orderDetails;
        }

        // Order via WhatsApp
        function orderViaWhatsApp() {
            // Check privacy consent
            const privacyConsent = document.getElementById('privacyConsent');
            if (!privacyConsent.checked) {
                showToast('Fehler', 'Bitte stimmen Sie der Datenschutzerkl√§rung zu.');
                return;
            }

            const nameInput = document.getElementById('customerName');
            const name = nameInput.value.trim();

            const orderDetails = prepareOrderDetails();

            // ============================================================
            // WhatsApp Nummer hier √§ndern (Format: 49 + Nummer ohne +0)
            // Beispiel: 0176 456 789 000 ‚Üí 4917645678900
            // ============================================================
            const whatsappNumber = '4915259821293';

            // Build message
            let message = 'üé® *Neue Bestellung von LayerStore*\n\n';

            if (name) {
                message += `üë§ *Name:* ${name}\n`;
            }

            message += '\n' + orderDetails;

            // Encode message for URL
            const encodedMessage = encodeURIComponent(message);

            // Open WhatsApp
            const whatsappUrl = `https://wa.me/${whatsappNumber}?text=${encodedMessage}`;
            window.open(whatsappUrl, '_blank');

            // Close modal and clear cart
            closeCheckoutModal();
            localStorage.removeItem('layerstore_cart');
            setAppliedPromoCode(null);  // Clear promo code
            updateCartCount();
            renderCart();
            nameInput.value = '';

            // Show success message
            showToast('WhatsApp ge√∂ffnet! üéâ', 'Vielen Dank! Senden Sie die Nachricht einfach ab.', 'success');
        }

        // Order via Email
        function orderViaEmail() {
            // Check privacy consent
            const privacyConsent = document.getElementById('privacyConsent');
            if (!privacyConsent.checked) {
                showToast('Fehler', 'Bitte stimmen Sie der Datenschutzerkl√§rung zu.');
                return;
            }

            const nameInput = document.getElementById('customerName');
            const name = nameInput.value.trim();

            const orderDetails = prepareOrderDetails();

            // Email recipient
            const recipientEmail = 'info@layerstore.eu';

            // Build email subject and body
            const subject = encodeURIComponent('Neue Bestellung von LayerStore');

            let emailBody = 'Neue Bestellung von LayerStore\n\n';

            if (name) {
                emailBody += `Name: ${name}\n`;
            }

            emailBody += '\n' + orderDetails;

            // Encode body
            const encodedBody = encodeURIComponent(emailBody);

            // Open email client
            const mailtoUrl = `mailto:${recipientEmail}?subject=${subject}&body=${encodedBody}`;
            window.location.href = mailtoUrl;

            // Close modal and clear cart
            closeCheckoutModal();
            localStorage.removeItem('layerstore_cart');
            setAppliedPromoCode(null);  // Clear promo code
            updateCartCount();
            renderCart();
            nameInput.value = '';

            // Show success message
            showToast('E-Mail ge√∂ffnet! ‚úâÔ∏è', 'Vielen Dank! Senden Sie die E-Mail einfach ab.', 'success');
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            loadPromoCodes();
            updateCartCount();
            renderCart();

            // Checkout modal event listeners
            const modal = document.getElementById('checkoutModal');
            const closeBtn = document.getElementById('closeCheckout');
            const whatsappBtn = document.getElementById('whatsappBtn');
            const emailBtn = document.getElementById('emailBtn');
            const privacyConsent = document.getElementById('privacyConsent');

            // Close modal on X button
            closeBtn.addEventListener('click', closeCheckoutModal);

            // Close modal on background click
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    closeCheckoutModal();
                }
            });

            // Close modal on Escape key
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && modal.classList.contains('active')) {
                    closeCheckoutModal();
                }
            });

            // WhatsApp button
            whatsappBtn.addEventListener('click', orderViaWhatsApp);

            // Email button
            emailBtn.addEventListener('click', orderViaEmail);

            // Privacy consent toggle
            privacyConsent.addEventListener('change', function() {
                whatsappBtn.disabled = !this.checked;
                emailBtn.disabled = !this.checked;
                updatePayButton();
            });

            // Initialize Stripe
            const stripe = Stripe('pk_live_51T58Qz1dTRGWAlnkoKWI9nN6T2xHl3ri5F4yVh7m6LBiEH1gUYQ6YKzoGdExuXcIoTcWWvlzzygtOPViyOnbFxIx00OsN789PW');
            const elements = stripe.elements();
            const card = elements.create('card', {
                style: {
                    base: {
                        fontSize: '16px',
                        color: '#424770',
                        '::placeholder': {
                            color: '#aab7c4',
                        },
                        fontFamily: "'Quicksand', sans-serif",
                    },
                    invalid: {
                        color: '#9e2146',
                    }
                }
            });
            card.mount('#card-element');

            // Payment tabs switching
            const paymentTabs = document.querySelectorAll('.payment-tab');
            const paymentContents = document.querySelectorAll('.payment-content');

            paymentTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const method = tab.dataset.method;

                    // Update tabs
                    paymentTabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');

                    // Update content
                    paymentContents.forEach(c => c.classList.remove('active'));
                    document.getElementById(method + 'Content').classList.add('active');
                });
            });

            // Card input validation
            card.addEventListener('change', ({error}) => {
                const displayError = document.getElementById('stripe-error');
                if (error) {
                    displayError.textContent = error.message;
                    displayError.classList.add('visible');
                } else {
                    displayError.classList.remove('visible');
                }
                updatePayButton();
            });

            function updatePayButton() {
                const submitBtn = document.getElementById('submitPaymentBtn');
                const isConsentChecked = privacyConsent.checked;
                submitBtn.disabled = !isConsentChecked;
            }

            // Submit payment
            const submitBtn = document.getElementById('submitPaymentBtn');
            submitBtn.addEventListener('click', async (event) => {
                event.preventDefault();

                const nameInput = document.getElementById('customerName');
                const name = nameInput.value.trim() || 'Kunde';

                // Change loading state
                submitBtn.disabled = true;
                document.getElementById('buttonText').style.display = 'none';
                document.getElementById('buttonLoading').style.display = 'inline';

                // Create payment intent (requires server endpoint)
                // For now, show message that server integration is needed
                const displayError = document.getElementById('stripe-error');
                displayError.textContent = 'Hinweis: Server-Integration erforderlich. Bitte kontaktieren Sie uns vorerst √ºber WhatsApp oder E-Mail.';
                displayError.classList.add('visible');

                // Reset button state
                submitBtn.disabled = false;
                document.getElementById('buttonText').style.display = 'inline';
                document.getElementById('buttonLoading').style.display = 'none';

                /* Example server integration code:
                const response = await fetch('/create-payment-intent', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        items: getCart(),
                        amount: calculateTotal() * 100,
                        currency: 'eur'
                    })
                });

                const { clientSecret } = await response.json();

                const { error, paymentIntent } = await stripe.confirmCardPayment(clientSecret, {
                    payment_method: { card: card, billing_details: { name: name } }
                });

                if (error) {
                    displayError.textContent = error.message;
                    displayError.classList.add('visible');
                    submitBtn.disabled = false;
                } else {
                    // Payment successful
                    localStorage.removeItem('layerstore_cart');
                    closeCheckoutModal();
                    renderCart();
                    showToast('Zahlung erfolgreich!', 'Vielen Dank f√ºr Ihre Bestellung.', 'success');
                }
                */
            });
        });
    </script>

    <!-- Cookie Banner -->
    <div class="cookie-banner" id="cookieBanner">
        <p>
            <strong>Wir verwenden Cookies.</strong>
            Diese Website verwendet technische Cookies (LocalStorage) f√ºr den Warenkorb.
            Zudem werden Google Fonts geladen. Weitere Informationen in unserer
            <a href="/datenschutz">Datenschutzerkl√§rung</a>.
        </p>
        <button id="acceptCookies">Akzeptieren</button>
    </div>

    <script>
        // Cookie Consent
        const COOKIE_CONSENT_KEY = 'layerstore_cookie_consent';

        function checkCookieConsent() {
            return localStorage.getItem(COOKIE_CONSENT_KEY) === 'accepted';
        }

        function setCookieConsent() {
            localStorage.setItem(COOKIE_CONSENT_KEY, 'accepted');
            hideCookieBanner();
        }

        function hideCookieBanner() {
            const banner = document.getElementById('cookieBanner');
            if (banner) {
                banner.classList.remove('show');
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            if (!checkCookieConsent()) {
                setTimeout(() => {
                    const banner = document.getElementById('cookieBanner');
                    if (banner) {
                        banner.classList.add('show');
                    }
                }, 500);
            }

            const acceptBtn = document.getElementById('acceptCookies');
            if (acceptBtn) {
                acceptBtn.addEventListener('click', setCookieConsent);
            }
        });
    </script>
</body>
</html>
